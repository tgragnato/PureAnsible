---

- name: Setting net.inet.ip.portfirst
  sysctl:
    name: net.inet.ip.portfirst
    value: 49152

- name: Setting net.inet.ip.portlast
  sysctl:
    name: net.inet.ip.portlast
    value: 65535

- name: Setting net.inet.ip.forwarding
  sysctl:
    name: net.inet.ip.forwarding
    value: 1

- name: Setting net.inet.tcp.ackonpush
  sysctl:
    name: net.inet.tcp.ackonpush
    value: 1

- name: Setting net.inet.tcp.mssdflt
  sysctl:
    name: net.inet.tcp.mssdflt
    value: 1440

- name: Install dhcpd.conf
  copy:
    src: dhcpd.conf
    dest: /etc/dhcpd.conf
    owner: root
    group: wheel
    mode: 0644

- name: Setting the DHCP daemon
  service:
    name: dhcpd
    args: vether0
    state: started
    enabled: yes

- name: Install hostname.vether0
  copy:
    src: hostname.vether0
    dest: /etc/hostname.vether0
    owner: root
    group: wheel
    mode: 0640

- name: Install hostname.bridge0
  copy:
    src: hostname.bridge0
    dest: /etc/hostname.bridge0
    owner: root
    group: wheel
    mode: 0640

- name: Install hostname file for bridge members
  copy:
    src: hostname.lan
    dest: /etc/hostname.{{item}}
    owner: root
    group: wheel
    mode: 0640
  with_items:
    - em1
    - em2
    - em3
    - fxp0

- name: Install firewall configuration
  copy:
    src: pf.conf
    dest: /etc/pf.conf
    owner: root
    group: wheel
    mode: 0600